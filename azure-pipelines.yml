variables:
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
  BuildConfiguration: "Release"

trigger: 
  - master
pr:
- master
jobs:
  - job: "BuildWindows"
    displayName: "Windows - Building .NET Application"
    pool:
      vmImage: 'windows-2019'
    steps:
      - task: DotNetCoreInstaller@1
        displayName: "Use .NET Core sdk 3.1.201"
        inputs:
          version: 3.1.201
      - task: DotNetCoreCLI@2
        displayName: 'Test Windows'
        inputs:
          command: test
          publishTestResults: true
      - task: DotNetCoreCLI@2
        displayName:  'Pack'
        inputs:
          command: pack
      - task: PublishPipelineArtifact@1
        displayName: "Publish Artifact"
        inputs:
          targetPath: "$(build.artifactstagingdirectory)"
          ArtifactName: "build"
  - job: "BuildLinux"
    displayName: "Linux - Building .NET Application"
    pool:
      vmImage: 'ubuntu-latest'
    steps:
      - task: DotNetCoreInstaller@1
        displayName: "Use .NET Core sdk 3.1.201"
        inputs:
          version: 3.1.201
      - task: DotNetCoreCLI@2
        inputs:
          displayName: 'Test Linux'
          command: test
      - task: DotNetCoreCLI@2
        inputs:
          command: build
